The repository 'mavrich_mbio_2019' contain the scripts
used for the analyses in the publication Mavrich & Hatfull, mBio, 2019. 
Below is a brief description of each script in the repository,
the requisite input files, and the output files.
The requisite input and output data files are available upon request.






1. Script: process_genome_distance.R

Description: compile whole genome nucleotide distance and whole genome
gene content dissimilarity metrics.


Input files:

    1. phage_metadata.csv
    
    Description: Information about all phages in the database.
    
    Data structure:
        1. Phage Name
        2. Host
        3. Cluster
        4. Subcluster
        
        
    2. processed_mash_output.csv
    
    Description: pairwise whole genome nucleotide distance data generated by 
    Mash and processed using scripts published in Mavrich & Hatfull 2017.
    
    Data structure:
        1. Reference phage name
        2. Query phage Name
        3. Mash distance
        4. Mash p-value
        5. Mash kmer count
        6. Reference_Query identifier
    
    
    3. pairwise_pham_proportions.csv
    
    Description: pairwise whole genome averaged pham proportion data generated
    by scripts published in Mavrich & Hatfull 2017.
    
    Data structure:
        1. Phage1 name
        2. Phage1 number of unshared phams
        3. Phage1 shared proportion
        4. Phage2 name
        5. Phage2 number of unshared phams
        6. Phage2 shared proportion
        7. Number of shared phams
        8. Average shared proportion
        9. Jaccard similarity
        10. Shared pham distribution mean
        11. Shared pham distribution median
        12. Shared pham distribution max
        13. Unshared pham distribution mean
        14. Unshared pham distribution median
        15. Unshared pham distribution max
        16. Unshared orpham count


 

 


Output files:

    1. genomic_distance_data.csv

    Description: Pairwise comparisons that are used in the 
    analyze_immunity_data.R script. Dataset contains self comparisons
    (i.e. L5 compared to L5) as well as reciprocal comparisons (i.e.
    L5 compared to Trixie and Trixie compared to L5).
    
    Data structure:
        2. Phage1_Phage2
        3. Modified Mash distance
        4. Gene content dissimilarity


    2. data_for_mode_prediction.csv

    Description: Pairwise comparisons within intra-cluster boundaries
    (as defined by Mavrich & Hatfull 2017) so that evolutionary mode can be
    identified, as published in Mavrich & Hatfull 2017 
    (but not used in this publication).
    
    Data structure:
        1. Reference phage name
        2. Query phage name
        3. Modified Mash distance
        4. Gene content dissimilarity


    3. data_for_maxgcdgap_all.csv

    Description: All pairwise comparisons, which can be used to compute 
    MaxGCDGap as published in Pope et al. 2017
    (but not used in this publication).

    Data structure:
        1. Reference phage name
        2. Query phage name
        3. Modified Mash distance
        4. Gene content dissimilarity
        
        
    4. data_for_mash_network_nuc005.csv
    
    Description: All pairwise comparisons below Mash distance of 0.05. 
    This can be used to create phage networks
    (but not used in this publication).
    
    Data structure:
        1. Reference phage name
        2. Query phage name
        3. Modified Mash distance
        4. Mash p-value
        5. Mash kmer count
        6. Reference_Query identifier















2. Script: analyze_immunity_data.R

Description: 


Input files:


1. genomic_distance_data.csv

Description: Pairwise Mash-based nucleotide distances or Pham-based gene
content dissimilarities for all phages in the Actinobacteriophage_1321
database, computed as previously described in Mavrich & Hatfull 2017.


2. phage_metadata.csv

Compilation of misc. data for each phage in the Actinobacteriophage_1321
database, generated from multiple tools.



3. repressor_distance_data.csv

4. portal_distance_data.csv

5. recb_distance_data.csv

6. repressor336_distance_data.csv

Description: Pairwise genetic distances of 336 Immunity Repressor homologs.

7. cas4311_distance_data.csv

Description: Pairwise genetic distances of 311 Cas4-family homologs.


8. endovii306_distance_data.csv

Description: Pairwise genetic distances of 306 Endonuclease VII homologs.


9. dnapol311_distance_data.csv

Description: Pairwise genetic distances of 311 DNA Polymerase homologs.


10. portal311_distance_data.csv

Description: Pairwise genetic distances of 311 Portal homologs.


11. stoperator_pwm_data.csv

Description: Pairwise distances between 327 position weight matrices generated
from predicted stoperators within each of the 327 Cluster A phage genomes.


12. stoperator_site_predictions.csv

Description: Table of predicted stoperator sites from all 327 Cluster A phage
genomes using the position weight matrices listed above.


13. multi_lys_ave_infection_table_reduced.csv

Description: 



Data analysis scripts:

1. analyze_immunity_data.R

Description: RStudio script to ...





    Output files:
    
    1. conf_assay_strain_def_chal_average.csv
    
    Description: Processed infection data, with low-confidence data removed
    and all replicate assay results averaged.
    
    
    2. reciprocal_data_alpha_ordered.csv
    
    Description:
    
    
    3. mutant_analysis.csv
    
    
    Description:








