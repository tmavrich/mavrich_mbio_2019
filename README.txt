The repository 'mavrich_mbio_2019' contain the scripts
used for the analyses in the publication Mavrich & Hatfull, mBio, 2019. 
Below is a brief description of each script in the repository,
the requisite input files, and the output files.
The requisite input and output data files are available upon request.






1. Script: process_genome_distance.R

Description: compile whole genome nucleotide distance and whole genome
gene content dissimilarity metrics.


Input files:

    1. phage_metadata.csv
    
    Description: Information about all phages in the database.
    
    Data structure:
        1. Phage Name
        2. Host
        3. Cluster
        4. Subcluster
        
        
    2. processed_mash_output.csv
    
    Description: pairwise whole genome nucleotide distance data generated by 
    Mash and processed using scripts published in Mavrich & Hatfull 2017.
    
    Data structure:
        1. Reference phage name
        2. Query phage Name
        3. Mash distance
        4. Mash p-value
        5. Mash kmer count
        6. Reference_Query identifier
    
    
    3. pairwise_pham_proportions.csv
    
    Description: pairwise whole genome averaged pham proportion data generated
    by scripts published in Mavrich & Hatfull 2017.
    
    Data structure:
        1. Phage1 name
        2. Phage1 number of unshared phams
        3. Phage1 shared proportion
        4. Phage2 name
        5. Phage2 number of unshared phams
        6. Phage2 shared proportion
        7. Number of shared phams
        8. Average shared proportion
        9. Jaccard similarity
        10. Shared pham distribution mean
        11. Shared pham distribution median
        12. Shared pham distribution max
        13. Unshared pham distribution mean
        14. Unshared pham distribution median
        15. Unshared pham distribution max
        16. Unshared orpham count


 

 


Output files:

    1. genomic_distance_data.csv

    Description: Pairwise comparisons that are used in the 
    analyze_immunity_data.R script. Dataset contains self comparisons
    (i.e. L5 compared to L5) as well as reciprocal comparisons (i.e.
    L5 compared to Trixie and Trixie compared to L5).
    
    Data structure:
        2. Phage1_Phage2
        3. Modified Mash distance
        4. Gene content dissimilarity


    2. data_for_mode_prediction.csv

    Description: Pairwise comparisons within intra-cluster boundaries
    (as defined by Mavrich & Hatfull 2017) so that evolutionary mode can be
    identified, as published in Mavrich & Hatfull 2017 
    (but not used in this publication).
    
    Data structure:
        1. Reference phage name
        2. Query phage name
        3. Modified Mash distance
        4. Gene content dissimilarity


    3. data_for_maxgcdgap_all.csv

    Description: All pairwise comparisons, which can be used to compute 
    MaxGCDGap as published in Pope et al. 2017
    (but not used in this publication).

    Data structure:
        1. Reference phage name
        2. Query phage name
        3. Modified Mash distance
        4. Gene content dissimilarity
        
        
    4. data_for_mash_network_nuc005.csv
    
    Description: All pairwise comparisons below Mash distance of 0.05. 
    This can be used to create phage networks
    (but not used in this publication).
    
    Data structure:
        1. Reference phage name
        2. Query phage name
        3. Modified Mash distance
        4. Mash p-value
        5. Mash kmer count
        6. Reference_Query identifier







2. Script: process_stoperator_data.R

Description: Using previously identified potential binding sites, create 
binding site position weight matrices (PWMs), compute the pairwise distance
between PWMs, and scan all genomes for potential binding sites for each
PWM.


Input files:

    1. phage_metadata.csv
    
    Description: Information about all phages in the database.
    
    Data structure:
        1. Phage Name
        2. Genome size (TODO is this field needed?)
        3. Coordinate indicating the center of the genome (TODO is this field needed?)
    
    
    2. stoperator_data.csv
    
    Description:
    
    Data structure:
        1. Phage Name
        2. Unique stoperator ID 
        3. Stoperator sequence (13bp)
    
    
    
    3. folder of fasta-formatted genome sequences
    
    Description: All genomes that need to be analyzed. One file per genome,
    fasta-formatted.






Output files:

    1. biostrings_stoperators.csv
    
    Description: Table of stoperator binding sites for each genome, derived
    from the input stoperator data, and containing confirmed coordinate and
    sequence data.
    
    
    Data structure:
        1. Phage Name
        2. Forward sequence
        3. Reverse sequence
        4. Start coordinate
        5. End coordinate
        6. Strand
        7. Unique stoperator ID
        8. TODO still needed?
        9. TODO still needed?
        10. TODO still needed?



    2. stoperator_pwm_distances.csv (TODO make sure output file is correctly named)
    
    Description: Pairwise genetic distances between PWMs that were generated
    using log2probratio.
    
    Data structure:
        1. Phage 1
        2. Phage 2
        3. Pearson distance (TODO normalized?)
        4. Normalized Euclidean distance


    3. 





3. Script: analyze_immunity_data.R

Description: Compare superinfection immunity phenotypes with genomic 
characteristics to identify how immunity changes as phages evolve.


Input files:


    1. genomic_distance_data.csv

    Description: Pairwise Mash-based nucleotide distances or Pham-based gene
    content dissimilarities for all phages in the Actinobacteriophage_1321
    database, computed as previously described in Mavrich & Hatfull 2017.


    2. phage_metadata.csv

    Description: Compilation of misc. data for each phage in the Actinobacteriophage_1321
    database, generated from multiple tools.

    Data structure:
        1.
        2.
        3.
        4.



    6. repressor336_distance_data.csv

    Description: Pairwise genetic distances of 336 Immunity Repressor homologs.

    Data structure:
        1.
        2.
        3.
        4.

    7. cas4311_distance_data.csv

    Description: Pairwise genetic distances of 311 Cas4-family homologs.

    Data structure:
        1.
        2.
        3.
        4.


    8. endovii306_distance_data.csv

    Description: Pairwise genetic distances of 306 Endonuclease VII homologs.

    Data structure:
        1.
        2.
        3.
        4.


    9. dnapol311_distance_data.csv

    Description: Pairwise genetic distances of 311 DNA Polymerase homologs.

    Data structure:
        1.
        2.
        3.
        4.


    10. portal311_distance_data.csv

    Description: Pairwise genetic distances of 311 Portal homologs.

    Data structure:
        1.
        2.
        3.
        4.


    11. stoperator_pwm_data.csv

    Description: Pairwise distances between 327 position weight matrices generated
    from predicted stoperators within each of the 327 Cluster A phage genomes.

    Data structure:
        1.
        2.
        3.
        4.


    12. stoperator_site_predictions.csv

    Description: Table of predicted stoperator sites from all 327 Cluster A phage
    genomes using the position weight matrices listed above.

    Data structure:
        1.
        2.
        3.
        4.


    13. multi_lys_ave_infection_table_reduced.csv

    Description: 

    Data structure:
        1.
        2.
        3.
        4.





Output files:
    
    1. conf_assay_strain_def_chal_average.csv
    
    Description: Processed infection data, with low-confidence data removed
    and all replicate assay results averaged.
    
    
    2. reciprocal_data_alpha_ordered.csv
    
    Description:
    
    
    3. mutant_analysis.csv
    
    
    Description:








